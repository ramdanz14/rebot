-- 51Per ItemAll :

SELECT A.CAT_COD,A.PRDCD,A.SINGKATAN,A.PRC PRICE,TAG,C.TTL_TOKO TK_MAIN,ROUND(minor) MINOR,AVG(SPD) SPD,AVG(PKM) PKM,
SUM(STO) H_STO,SUM(LOSS) LOSS,B.TTL_TOKO JML_TOKO
FROM BTK_STO A,(SELECT PRDCD,COUNT(KODE_TOKO) TTL_TOKO,SUM(IF(LOSS<>0,1,0)) TTL_STO
FROM BTK_STO GROUP BY PRDCD) B,TOKOMAIN C
WHERE A.PRDCD=B.PRDCD AND A.PRDCD=C.PRDCD GROUP BY PRDCD LIMIT 1000000;


-- 52Per TokoAll :

SELECT  A.KODE_TOKO,NAMATOKO,C.TTL_PLU PLUMAIN,SUM(STO) TTL_HR_STO,MAX(STO) MAX_HR_STO,
SUM(LOSS) LOSS,JML_ITEM JML_ITEM_STO,TGL_BUKA
FROM BTK_STO A,(SELECT KODE_TOKO,COUNT(PRDCD) JML_ITEM FROM BTK_STO WHERE TAG IN('E','D','S','L') GROUP BY KODE_TOKO) B
,PLUMAIN C WHERE A.KODE_TOKO=B.KODE_TOKO AND A.KODE_TOKO=C.`TOKO` 
AND A.TAG IN('E','D','S','L') GROUP BY A.KODE_TOKO LIMIT 1000000;


-- 53Per Toko ALLDRY Tag Blank :


SELECT  A.KODE_TOKO,NAMATOKO,C.TTL_PLU PLUMAIN,SUM(STO) TTL_HR_STO,MAX(STO) MAX_HR_STO,
SUM(LOSS) LOSS,JML_ITEM JML_ITEM_STO,TGL_BUKA
FROM BTK_STO A,(SELECT KODE_TOKO,COUNT(PRDCD) JML_ITEM FROM BTK_STO WHERE TAG is null GROUP BY KODE_TOKO) B
,PLUMAIN C WHERE A.KODE_TOKO=B.KODE_TOKO AND A.KODE_TOKO=C.`TOKO` 
AND (A.TAG='' OR A.TAG IS NULL)  GROUP BY A.KODE_TOKO LIMIT 1000000;


-- 54 Per TokoALL DRY  Tag T :
SELECT  A.KODE_TOKO,NAMATOKO,C.TTL_PLU PLUMAIN,SUM(STO) TTL_HR_STO,MAX(STO) MAX_HR_STO,
SUM(LOSS) LOSS,JML_ITEM JML_ITEM_STO,TGL_BUKA
FROM BTK_STO A,(SELECT KODE_TOKO,COUNT(PRDCD) JML_ITEM FROM BTK_STO WHERE TAG='T' GROUP BY KODE_TOKO) B
,PLUMAIN C WHERE A.KODE_TOKO=B.KODE_TOKO AND A.KODE_TOKO=C.`TOKO` 
AND A.TAG='T'  GROUP BY A.KODE_TOKO LIMIT 1000000;


-- 55 Per Toko(All)-(Dry) Tag V :

SELECT  A.KODE_TOKO,NAMATOKO,C.TTL_PLU PLUMAIN,SUM(STO) TTL_HR_STO,MAX(STO) MAX_HR_STO,
SUM(LOSS) LOSS,JML_ITEM JML_ITEM_STO,TGL_BUKA
FROM BTK_STO A,(SELECT KODE_TOKO,COUNT(PRDCD) JML_ITEM FROM BTK_STO WHERE TAG='V' GROUP BY KODE_TOKO) B
,PLUMAIN C WHERE A.KODE_TOKO=B.KODE_TOKO AND A.KODE_TOKO=C.`TOKO` 
AND A.TAG='V'  GROUP BY A.KODE_TOKO LIMIT 1000000;